<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>Class: ChallengeAssignment</title>

<link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script type="text/javascript" charset="utf-8" src="./js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="./index.html">Home</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>app/models/challenge_assignment.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link">ActiveRecord::Base
  
</nav>

    <!-- Included Modules -->
<nav id="includes-section" class="section">
  <h3 class="section-header">Included Modules</h3>

  <ul class="link-list">
  
  
    <li><span class="include">Comparable</span>
  
  
  </ul>
</nav>

    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-c-assign_offer-21">::assign_offer!</a>
    
    <li><a href="#method-c-assign_request-21">::assign_request!</a>
    
    <li><a href="#method-c-clear-21">::clear!</a>
    
    <li><a href="#method-c-delayed_generate">::delayed_generate</a>
    
    <li><a href="#method-c-delayed_send_out">::delayed_send_out</a>
    
    <li><a href="#method-c-do_assign_offer-21">::do_assign_offer!</a>
    
    <li><a href="#method-c-do_assign_request-21">::do_assign_request!</a>
    
    <li><a href="#method-c-generate">::generate</a>
    
    <li><a href="#method-c-perform">::perform</a>
    
    <li><a href="#method-c-send_out">::send_out</a>
    
    <li><a href="#method-c-unfulfilled_in_collection">::unfulfilled_in_collection</a>
    
    <li><a href="#method-c-unposted_in_collection">::unposted_in_collection</a>
    
    <li><a href="#method-c-update_placeholder_assignments-21">::update_placeholder_assignments!</a>
    
    <li><a href="#method-i-3C-3D-3E">#&lt;=&gt;</a>
    
    <li><a href="#method-i-clear_assignment">#clear_assignment</a>
    
    <li><a href="#method-i-cover">#cover</a>
    
    <li><a href="#method-i-default">#default</a>
    
    <li><a href="#method-i-defaulted">#defaulted</a>
    
    <li><a href="#method-i-defaulted-3D">#defaulted=</a>
    
    <li><a href="#method-i-fulfilled-3F">#fulfilled?</a>
    
    <li><a href="#method-i-get_collection_item">#get_collection_item</a>
    
    <li><a href="#method-i-offer_byline">#offer_byline</a>
    
    <li><a href="#method-i-offering_pseud">#offering_pseud</a>
    
    <li><a href="#method-i-offering_user">#offering_user</a>
    
    <li><a href="#method-i-pinch_hitter_byline">#pinch_hitter_byline</a>
    
    <li><a href="#method-i-pinch_hitter_byline-3D">#pinch_hitter_byline=</a>
    
    <li><a href="#method-i-pinch_request_byline">#pinch_request_byline</a>
    
    <li><a href="#method-i-pinch_request_byline-3D">#pinch_request_byline=</a>
    
    <li><a href="#method-i-posted-3F">#posted?</a>
    
    <li><a href="#method-i-request">#request</a>
    
    <li><a href="#method-i-request_byline">#request_byline</a>
    
    <li><a href="#method-i-requesting_pseud">#requesting_pseud</a>
    
    <li><a href="#method-i-send_out">#send_out</a>
    
    <li><a href="#method-i-title">#title</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="./app/mailers/README.html">README</a>
  
    <li class="file"><a href="./app/views/epub/mimetype.html">mimetype</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="./Static.html">Static</a>
  
    <li><a href="./Static/BaseController.html">Static::BaseController</a>
  
    <li><a href="./Static/CollectionsController.html">Static::CollectionsController</a>
  
    <li><a href="./Static/FandomsController.html">Static::FandomsController</a>
  
    <li><a href="./Static/MediaController.html">Static::MediaController</a>
  
    <li><a href="./Static/RestrictedWorksController.html">Static::RestrictedWorksController</a>
  
    <li><a href="./Static/WorksController.html">Static::WorksController</a>
  
    <li><a href="./Admin.html">Admin</a>
  
    <li><a href="./Admin/AdminInvitationsController.html">Admin::AdminInvitationsController</a>
  
    <li><a href="./Admin/AdminUsersController.html">Admin::AdminUsersController</a>
  
    <li><a href="./Admin/SettingsController.html">Admin::SettingsController</a>
  
    <li><a href="./Admin/SkinsController.html">Admin::SkinsController</a>
  
    <li><a href="./Admin/UserCreationsController.html">Admin::UserCreationsController</a>
  
    <li><a href="./Challenge.html">Challenge</a>
  
    <li><a href="./Challenge/GiftExchangeController.html">Challenge::GiftExchangeController</a>
  
    <li><a href="./Challenge/PromptMemeController.html">Challenge::PromptMemeController</a>
  
    <li><a href="./StoryParser.html">StoryParser</a>
  
    <li><a href="./StoryParser/Error.html">StoryParser::Error</a>
  
    <li><a href="./AbuseReport.html">AbuseReport</a>
  
    <li><a href="./AbuseReportsController.html">AbuseReportsController</a>
  
    <li><a href="./AdminMailer.html">AdminMailer</a>
  
    <li><a href="./AdminPost.html">AdminPost</a>
  
    <li><a href="./AdminPostTag.html">AdminPostTag</a>
  
    <li><a href="./AdminPostTagging.html">AdminPostTagging</a>
  
    <li><a href="./AdminPostsController.html">AdminPostsController</a>
  
    <li><a href="./AdminSession.html">AdminSession</a>
  
    <li><a href="./AdminSessionsController.html">AdminSessionsController</a>
  
    <li><a href="./AdminSetting.html">AdminSetting</a>
  
    <li><a href="./AdminsController.html">AdminsController</a>
  
    <li><a href="./AdvancedSearchHelper.html">AdvancedSearchHelper</a>
  
    <li><a href="./AlphabetHelper.html">AlphabetHelper</a>
  
    <li><a href="./ApplicationController.html">ApplicationController</a>
  
    <li><a href="./ApplicationHelper.html">ApplicationHelper</a>
  
    <li><a href="./ArchiveFaq.html">ArchiveFaq</a>
  
    <li><a href="./ArchiveFaqsController.html">ArchiveFaqsController</a>
  
    <li><a href="./AutocompleteController.html">AutocompleteController</a>
  
    <li><a href="./Banned.html">Banned</a>
  
    <li><a href="./Bookmark.html">Bookmark</a>
  
    <li><a href="./BookmarksController.html">BookmarksController</a>
  
    <li><a href="./BookmarksHelper.html">BookmarksHelper</a>
  
    <li><a href="./CacheHelper.html">CacheHelper</a>
  
    <li><a href="./CastNomination.html">CastNomination</a>
  
    <li><a href="./Category.html">Category</a>
  
    <li><a href="./ChallengeAssignment.html">ChallengeAssignment</a>
  
    <li><a href="./ChallengeAssignmentsController.html">ChallengeAssignmentsController</a>
  
    <li><a href="./ChallengeClaim.html">ChallengeClaim</a>
  
    <li><a href="./ChallengeClaimsController.html">ChallengeClaimsController</a>
  
    <li><a href="./ChallengeHelper.html">ChallengeHelper</a>
  
    <li><a href="./ChallengeRequestsController.html">ChallengeRequestsController</a>
  
    <li><a href="./ChallengeSignup.html">ChallengeSignup</a>
  
    <li><a href="./ChallengeSignupObserver.html">ChallengeSignupObserver</a>
  
    <li><a href="./ChallengeSignupSweeper.html">ChallengeSignupSweeper</a>
  
    <li><a href="./ChallengeSignupsController.html">ChallengeSignupsController</a>
  
    <li><a href="./ChallengeSweeper.html">ChallengeSweeper</a>
  
    <li><a href="./ChallengesController.html">ChallengesController</a>
  
    <li><a href="./Chapter.html">Chapter</a>
  
    <li><a href="./ChapterSweeper.html">ChapterSweeper</a>
  
    <li><a href="./ChaptersController.html">ChaptersController</a>
  
    <li><a href="./ChaptersHelper.html">ChaptersHelper</a>
  
    <li><a href="./Character.html">Character</a>
  
    <li><a href="./CharacterNomination.html">CharacterNomination</a>
  
    <li><a href="./Collection.html">Collection</a>
  
    <li><a href="./CollectionItem.html">CollectionItem</a>
  
    <li><a href="./CollectionItemsController.html">CollectionItemsController</a>
  
    <li><a href="./CollectionObserver.html">CollectionObserver</a>
  
    <li><a href="./CollectionParticipant.html">CollectionParticipant</a>
  
    <li><a href="./CollectionParticipantsController.html">CollectionParticipantsController</a>
  
    <li><a href="./CollectionPreference.html">CollectionPreference</a>
  
    <li><a href="./CollectionProfile.html">CollectionProfile</a>
  
    <li><a href="./CollectionProfileController.html">CollectionProfileController</a>
  
    <li><a href="./CollectionSweeper.html">CollectionSweeper</a>
  
    <li><a href="./CollectionsController.html">CollectionsController</a>
  
    <li><a href="./CollectionsHelper.html">CollectionsHelper</a>
  
    <li><a href="./Comment.html">Comment</a>
  
    <li><a href="./CommentMailer.html">CommentMailer</a>
  
    <li><a href="./CommentObserver.html">CommentObserver</a>
  
    <li><a href="./CommentSweeper.html">CommentSweeper</a>
  
    <li><a href="./CommentsController.html">CommentsController</a>
  
    <li><a href="./CommentsHelper.html">CommentsHelper</a>
  
    <li><a href="./CommonTagging.html">CommonTagging</a>
  
    <li><a href="./CreationObserver.html">CreationObserver</a>
  
    <li><a href="./Creatorship.html">Creatorship</a>
  
    <li><a href="./DateHelper.html">DateHelper</a>
  
    <li><a href="./DevmodeController.html">DevmodeController</a>
  
    <li><a href="./DownloadsController.html">DownloadsController</a>
  
    <li><a href="./EmailVeracityValidator.html">EmailVeracityValidator</a>
  
    <li><a href="./ErrorsController.html">ErrorsController</a>
  
    <li><a href="./ExternalAuthor.html">ExternalAuthor</a>
  
    <li><a href="./ExternalAuthorName.html">ExternalAuthorName</a>
  
    <li><a href="./ExternalAuthorsController.html">ExternalAuthorsController</a>
  
    <li><a href="./ExternalAuthorsHelper.html">ExternalAuthorsHelper</a>
  
    <li><a href="./ExternalCreatorship.html">ExternalCreatorship</a>
  
    <li><a href="./ExternalWork.html">ExternalWork</a>
  
    <li><a href="./ExternalWorksController.html">ExternalWorksController</a>
  
    <li><a href="./Fandom.html">Fandom</a>
  
    <li><a href="./FandomNomination.html">FandomNomination</a>
  
    <li><a href="./FandomsController.html">FandomsController</a>
  
    <li><a href="./FeedSweeper.html">FeedSweeper</a>
  
    <li><a href="./Feedback.html">Feedback</a>
  
    <li><a href="./FeedbacksController.html">FeedbacksController</a>
  
    <li><a href="./FilterCount.html">FilterCount</a>
  
    <li><a href="./FilterTagging.html">FilterTagging</a>
  
    <li><a href="./Freeform.html">Freeform</a>
  
    <li><a href="./FreeformNomination.html">FreeformNomination</a>
  
    <li><a href="./Gift.html">Gift</a>
  
    <li><a href="./GiftExchange.html">GiftExchange</a>
  
    <li><a href="./GiftsController.html">GiftsController</a>
  
    <li><a href="./HitCounter.html">HitCounter</a>
  
    <li><a href="./HomeController.html">HomeController</a>
  
    <li><a href="./HomeHelper.html">HomeHelper</a>
  
    <li><a href="./InboxComment.html">InboxComment</a>
  
    <li><a href="./InboxController.html">InboxController</a>
  
    <li><a href="./InboxHelper.html">InboxHelper</a>
  
    <li><a href="./Invitation.html">Invitation</a>
  
    <li><a href="./InvitationsController.html">InvitationsController</a>
  
    <li><a href="./InvitationsHelper.html">InvitationsHelper</a>
  
    <li><a href="./InviteRequest.html">InviteRequest</a>
  
    <li><a href="./InviteRequestsController.html">InviteRequestsController</a>
  
    <li><a href="./KnownIssue.html">KnownIssue</a>
  
    <li><a href="./KnownIssuesController.html">KnownIssuesController</a>
  
    <li><a href="./Kudo.html">Kudo</a>
  
    <li><a href="./KudoMailer.html">KudoMailer</a>
  
    <li><a href="./KudoObserver.html">KudoObserver</a>
  
    <li><a href="./KudosController.html">KudosController</a>
  
    <li><a href="./Language.html">Language</a>
  
    <li><a href="./LanguagesController.html">LanguagesController</a>
  
    <li><a href="./Locale.html">Locale</a>
  
    <li><a href="./LocalesController.html">LocalesController</a>
  
    <li><a href="./LogItem.html">LogItem</a>
  
    <li><a href="./Media.html">Media</a>
  
    <li><a href="./MediaController.html">MediaController</a>
  
    <li><a href="./MetaTagging.html">MetaTagging</a>
  
    <li><a href="./Object.html">Object</a>
  
    <li><a href="./Offer.html">Offer</a>
  
    <li><a href="./OrphansController.html">OrphansController</a>
  
    <li><a href="./OrphansHelper.html">OrphansHelper</a>
  
    <li><a href="./OwnedSetTagging.html">OwnedSetTagging</a>
  
    <li><a href="./OwnedTagSet.html">OwnedTagSet</a>
  
    <li><a href="./OwnedTagSetsController.html">OwnedTagSetsController</a>
  
    <li><a href="./PasswordsController.html">PasswordsController</a>
  
    <li><a href="./People.html">People</a>
  
    <li><a href="./PeopleController.html">PeopleController</a>
  
    <li><a href="./PotentialMatch.html">PotentialMatch</a>
  
    <li><a href="./PotentialMatchSettings.html">PotentialMatchSettings</a>
  
    <li><a href="./PotentialMatchesController.html">PotentialMatchesController</a>
  
    <li><a href="./PotentialPromptMatch.html">PotentialPromptMatch</a>
  
    <li><a href="./Preference.html">Preference</a>
  
    <li><a href="./PreferencesController.html">PreferencesController</a>
  
    <li><a href="./Profile.html">Profile</a>
  
    <li><a href="./ProfileController.html">ProfileController</a>
  
    <li><a href="./Prompt.html">Prompt</a>
  
    <li><a href="./PromptMeme.html">PromptMeme</a>
  
    <li><a href="./PromptRestriction.html">PromptRestriction</a>
  
    <li><a href="./PromptRestrictionsHelper.html">PromptRestrictionsHelper</a>
  
    <li><a href="./PromptsController.html">PromptsController</a>
  
    <li><a href="./Pseud.html">Pseud</a>
  
    <li><a href="./PseudSweeper.html">PseudSweeper</a>
  
    <li><a href="./PseudsController.html">PseudsController</a>
  
    <li><a href="./PseudsHelper.html">PseudsHelper</a>
  
    <li><a href="./Rating.html">Rating</a>
  
    <li><a href="./Reading.html">Reading</a>
  
    <li><a href="./ReadingsController.html">ReadingsController</a>
  
    <li><a href="./RedirectController.html">RedirectController</a>
  
    <li><a href="./RelatedWork.html">RelatedWork</a>
  
    <li><a href="./RelatedWorksController.html">RelatedWorksController</a>
  
    <li><a href="./Relationship.html">Relationship</a>
  
    <li><a href="./RelationshipNomination.html">RelationshipNomination</a>
  
    <li><a href="./Request.html">Request</a>
  
    <li><a href="./Role.html">Role</a>
  
    <li><a href="./RolesUser.html">RolesUser</a>
  
    <li><a href="./SearchController.html">SearchController</a>
  
    <li><a href="./SearchHelper.html">SearchHelper</a>
  
    <li><a href="./SerialWork.html">SerialWork</a>
  
    <li><a href="./SerialWorksController.html">SerialWorksController</a>
  
    <li><a href="./Series.html">Series</a>
  
    <li><a href="./SeriesController.html">SeriesController</a>
  
    <li><a href="./SeriesHelper.html">SeriesHelper</a>
  
    <li><a href="./SetTagging.html">SetTagging</a>
  
    <li><a href="./Skin.html">Skin</a>
  
    <li><a href="./SkinParent.html">SkinParent</a>
  
    <li><a href="./SkinsController.html">SkinsController</a>
  
    <li><a href="./SkinsHelper.html">SkinsHelper</a>
  
    <li><a href="./StaticSweeper.html">StaticSweeper</a>
  
    <li><a href="./StatsController.html">StatsController</a>
  
    <li><a href="./StatsHelper.html">StatsHelper</a>
  
    <li><a href="./Subscription.html">Subscription</a>
  
    <li><a href="./SubscriptionsController.html">SubscriptionsController</a>
  
    <li><a href="./Tag.html">Tag</a>
  
    <li><a href="./TagNomination.html">TagNomination</a>
  
    <li><a href="./TagNominationsController.html">TagNominationsController</a>
  
    <li><a href="./TagSet.html">TagSet</a>
  
    <li><a href="./TagSetAssociation.html">TagSetAssociation</a>
  
    <li><a href="./TagSetAssociationsController.html">TagSetAssociationsController</a>
  
    <li><a href="./TagSetNomination.html">TagSetNomination</a>
  
    <li><a href="./TagSetNominationsController.html">TagSetNominationsController</a>
  
    <li><a href="./TagSetOwnership.html">TagSetOwnership</a>
  
    <li><a href="./TagSetSweeper.html">TagSetSweeper</a>
  
    <li><a href="./TagSetsHelper.html">TagSetsHelper</a>
  
    <li><a href="./TagSweeper.html">TagSweeper</a>
  
    <li><a href="./TagWranglersController.html">TagWranglersController</a>
  
    <li><a href="./TagWranglingsController.html">TagWranglingsController</a>
  
    <li><a href="./Tagging.html">Tagging</a>
  
    <li><a href="./TagsController.html">TagsController</a>
  
    <li><a href="./TagsHelper.html">TagsHelper</a>
  
    <li><a href="./TranslationHelper.html">TranslationHelper</a>
  
    <li><a href="./TranslationNote.html">TranslationNote</a>
  
    <li><a href="./TranslationNotesController.html">TranslationNotesController</a>
  
    <li><a href="./TranslationsController.html">TranslationsController</a>
  
    <li><a href="./TranslatorsController.html">TranslatorsController</a>
  
    <li><a href="./UrlActiveValidator.html">UrlActiveValidator</a>
  
    <li><a href="./UrlFormatValidator.html">UrlFormatValidator</a>
  
    <li><a href="./User.html">User</a>
  
    <li><a href="./UserInviteRequest.html">UserInviteRequest</a>
  
    <li><a href="./UserInviteRequestsController.html">UserInviteRequestsController</a>
  
    <li><a href="./UserInviteRequestsHelper.html">UserInviteRequestsHelper</a>
  
    <li><a href="./UserMailer.html">UserMailer</a>
  
    <li><a href="./UserSession.html">UserSession</a>
  
    <li><a href="./UserSessionsController.html">UserSessionsController</a>
  
    <li><a href="./UsersController.html">UsersController</a>
  
    <li><a href="./UsersHelper.html">UsersHelper</a>
  
    <li><a href="./ValidationHelper.html">ValidationHelper</a>
  
    <li><a href="./Warning.html">Warning</a>
  
    <li><a href="./WeightedRandom.html">WeightedRandom</a>
  
    <li><a href="./Work.html">Work</a>
  
    <li><a href="./WorkObserver.html">WorkObserver</a>
  
    <li><a href="./WorkSkin.html">WorkSkin</a>
  
    <li><a href="./WorkSweeper.html">WorkSweeper</a>
  
    <li><a href="./WorksController.html">WorksController</a>
  
    <li><a href="./WorksHelper.html">WorksHelper</a>
  
    <li><a href="./WranglingAssignment.html">WranglingAssignment</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class ChallengeAssignment</h1>

  <div id="description" class="description">
    
  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <!-- Constants -->
    <section id="constants-list" class="section">
      <h3 class="section-header">Constants</h3>
      <dl>
      
        <dt id="ALL">ALL
        
        <dd class="description"><p>We use “-1” to represent all the requested items matching</p>
        
      
        <dt id="COLLECTION_ITEMS_JOIN">COLLECTION_ITEMS_JOIN
        
        <dd class="description"><p>sorting by fulfilled/posted status</p>
        
      
        <dt id="COLLECTION_ITEMS_LEFT_JOIN">COLLECTION_ITEMS_LEFT_JOIN
        
        <dd class="description">
        
      
        <dt id="OFFERING_PSEUD_JOIN">OFFERING_PSEUD_JOIN
        
        <dd class="description">
        
      
        <dt id="REQUESTING_PSEUD_JOIN">REQUESTING_PSEUD_JOIN
        
        <dd class="description"><p>sorting by request/offer</p>
        
      
        <dt id="WORKS_JOIN">WORKS_JOIN
        
        <dd class="description">
        
      
        <dt id="WORKS_LEFT_JOIN">WORKS_LEFT_JOIN
        
        <dd class="description">
        
      
      </dl>
    </section>
    

    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-assign_offer-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">assign_offer!</span><span
            class="method-args">(collection, offer_signup)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>go through the offer’s potential matches in order from best to worst and
try and assign</p>
          

          
          <div class="method-source-code" id="assign_offer-21-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 343</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">assign_offer!</span>(<span class="ruby-identifier">collection</span>, <span class="ruby-identifier">offer_signup</span>)
  <span class="ruby-identifier">assignment</span> = <span class="ruby-constant">ChallengeAssignment</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:collection</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">collection</span>, <span class="ruby-value">:offer_signup</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">offer_signup</span>)
  <span class="ruby-identifier">last_choice</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">assigned</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">offer_potential_matches</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">potential_match</span><span class="ruby-operator">|</span>
    <span class="ruby-comment"># skip if already assigned as a request</span>
    <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">potential_match</span>.<span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">assigned_as_request</span>

    <span class="ruby-comment"># if there's a circular match let's save it as our last choice</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">potential_match</span>.<span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">assigned_as_offer</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">last_choice</span> <span class="ruby-operator">&amp;&amp;</span>
        <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">assignments</span>.<span class="ruby-identifier">for_offer_signup</span>(<span class="ruby-identifier">potential_match</span>.<span class="ruby-identifier">request_signup</span>).<span class="ruby-identifier">first</span>.<span class="ruby-identifier">request_signup</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">offer_signup</span>
      <span class="ruby-identifier">last_choice</span> = <span class="ruby-identifier">potential_match</span>
      <span class="ruby-keyword">next</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># otherwise let's use it</span>
    <span class="ruby-identifier">assigned</span> = <span class="ruby-constant">ChallengeAssignment</span>.<span class="ruby-identifier">do_assign_offer!</span>(<span class="ruby-identifier">assignment</span>, <span class="ruby-identifier">potential_match</span>)
    <span class="ruby-keyword">break</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">assigned</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">last_choice</span>
    <span class="ruby-constant">ChallengeAssignment</span>.<span class="ruby-identifier">do_assign_offer!</span>(<span class="ruby-identifier">assignment</span>, <span class="ruby-identifier">last_choice</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">assigned_as_offer</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">save!</span>

  <span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">save!</span>
  <span class="ruby-identifier">assignment</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- assign_offer-21-source -->
          
        </div>

        

        
      </div><!-- assign_offer-21-method -->

    
      <div id="method-c-assign_request-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">assign_request!</span><span
            class="method-args">(collection, request_signup)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>go through the request’s potential matches in order from best to worst and
try and assign</p>
          

          
          <div class="method-source-code" id="assign_request-21-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 311</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">assign_request!</span>(<span class="ruby-identifier">collection</span>, <span class="ruby-identifier">request_signup</span>)
  <span class="ruby-identifier">assignment</span> = <span class="ruby-constant">ChallengeAssignment</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:collection</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">collection</span>, <span class="ruby-value">:request_signup</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">request_signup</span>)
  <span class="ruby-identifier">last_choice</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">assigned</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">request_potential_matches</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">potential_match</span><span class="ruby-operator">|</span>
    <span class="ruby-comment"># skip if this signup has already been assigned as an offer</span>
    <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">potential_match</span>.<span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">assigned_as_offer</span>

    <span class="ruby-comment"># if there's a circular match let's save it as our last choice</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">potential_match</span>.<span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">assigned_as_request</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">last_choice</span> <span class="ruby-operator">&amp;&amp;</span>
        <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">assignments</span>.<span class="ruby-identifier">for_request_signup</span>(<span class="ruby-identifier">potential_match</span>.<span class="ruby-identifier">offer_signup</span>).<span class="ruby-identifier">first</span>.<span class="ruby-identifier">offer_signup</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">request_signup</span>
      <span class="ruby-identifier">last_choice</span> = <span class="ruby-identifier">potential_match</span>
      <span class="ruby-keyword">next</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># otherwise let's use it</span>
    <span class="ruby-identifier">assigned</span> = <span class="ruby-constant">ChallengeAssignment</span>.<span class="ruby-identifier">do_assign_request!</span>(<span class="ruby-identifier">assignment</span>, <span class="ruby-identifier">potential_match</span>)
    <span class="ruby-keyword">break</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">assigned</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">last_choice</span>
    <span class="ruby-constant">ChallengeAssignment</span>.<span class="ruby-identifier">do_assign_request!</span>(<span class="ruby-identifier">assignment</span>, <span class="ruby-identifier">last_choice</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">assigned_as_request</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">save!</span>

  <span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">save!</span>
  <span class="ruby-identifier">assignment</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- assign_request-21-source -->
          
        </div>

        

        
      </div><!-- assign_request-21-method -->

    
      <div id="method-c-clear-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">clear!</span><span
            class="method-args">(collection)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>clear out all previous assignments. note: this does NOT invoke callbacks
because ChallengeAssignments don’t have any dependent=&gt;destroy or
associations</p>
          

          
          <div class="method-source-code" id="clear-21-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 389</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">clear!</span>(<span class="ruby-identifier">collection</span>)
  <span class="ruby-constant">ChallengeAssignment</span>.<span class="ruby-identifier">delete_all</span>(<span class="ruby-value">:collection_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">id</span>)
  <span class="ruby-constant">ChallengeSignup</span>.<span class="ruby-identifier">update_all</span>({<span class="ruby-value">:assigned_as_offer</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>, <span class="ruby-value">:assigned_as_request</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span>}, {<span class="ruby-value">:collection_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">id</span>})
<span class="ruby-keyword">end</span></pre>
          </div><!-- clear-21-source -->
          
        </div>

        

        
      </div><!-- clear-21-method -->

    
      <div id="method-c-delayed_generate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delayed_generate</span><span
            class="method-args">(collection_id)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="delayed_generate-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 255</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">delayed_generate</span>(<span class="ruby-identifier">collection_id</span>)
  <span class="ruby-identifier">collection</span> = <span class="ruby-constant">Collection</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">collection_id</span>)
  <span class="ruby-identifier">settings</span> = <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">challenge</span>.<span class="ruby-identifier">potential_match_settings</span>

  <span class="ruby-constant">ChallengeAssignment</span>.<span class="ruby-identifier">clear!</span>(<span class="ruby-identifier">collection</span>)

  <span class="ruby-comment"># we sort signups into buckets based on how many potential matches they have</span>
  <span class="ruby-ivar">@request_match_buckets</span> = {}
  <span class="ruby-ivar">@offer_match_buckets</span> = {}
  <span class="ruby-ivar">@max_match_count</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">no_match_required?</span>
     <span class="ruby-comment"># stuff everyone into the same bucket</span>
     <span class="ruby-ivar">@max_match_count</span> = <span class="ruby-value">1</span>
     <span class="ruby-ivar">@request_match_buckets</span>[<span class="ruby-value">1</span>] = <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">signups</span>
     <span class="ruby-ivar">@offer_match_buckets</span>[<span class="ruby-value">1</span>] = <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">signups</span>
  <span class="ruby-keyword">else</span>    
    <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">signups</span>.<span class="ruby-identifier">find_each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">signup</span><span class="ruby-operator">|</span>
      <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">signup</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">request_match_count</span> = <span class="ruby-identifier">signup</span>.<span class="ruby-identifier">request_potential_matches</span>.<span class="ruby-identifier">count</span>
      <span class="ruby-ivar">@request_match_buckets</span>[<span class="ruby-identifier">request_match_count</span>] <span class="ruby-operator">||=</span> []
      <span class="ruby-ivar">@request_match_buckets</span>[<span class="ruby-identifier">request_match_count</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">signup</span>
      <span class="ruby-ivar">@max_match_count</span> = (<span class="ruby-identifier">request_match_count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@max_match_count</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">request_match_count</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@max_match_count</span>)

      <span class="ruby-identifier">offer_match_count</span> = <span class="ruby-identifier">signup</span>.<span class="ruby-identifier">offer_potential_matches</span>.<span class="ruby-identifier">count</span>
      <span class="ruby-ivar">@offer_match_buckets</span>[<span class="ruby-identifier">offer_match_count</span>] <span class="ruby-operator">||=</span> []
      <span class="ruby-ivar">@offer_match_buckets</span>[<span class="ruby-identifier">offer_match_count</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">signup</span>
      <span class="ruby-ivar">@max_match_count</span> = (<span class="ruby-identifier">offer_match_count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@max_match_count</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">offer_match_count</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@max_match_count</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># now that we have the buckets, we go through assigning people in order</span>
  <span class="ruby-comment"># of people with the fewest options first.</span>
  <span class="ruby-comment"># if someone has no potential matches they still get an assignment, just with no</span>
  <span class="ruby-comment"># match.</span>
  <span class="ruby-value">0</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-ivar">@max_match_count</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">count</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@request_match_buckets</span>[<span class="ruby-identifier">count</span>]
      <span class="ruby-ivar">@request_match_buckets</span>[<span class="ruby-identifier">count</span>].<span class="ruby-identifier">sort_by</span> {<span class="ruby-identifier">rand</span>}.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">request_signup</span><span class="ruby-operator">|</span>
        <span class="ruby-comment"># go through the potential matches in order from best to worst and try and assign</span>
        <span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">reload</span>
        <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">assigned_as_request</span>
        <span class="ruby-constant">ChallengeAssignment</span>.<span class="ruby-identifier">assign_request!</span>(<span class="ruby-identifier">collection</span>, <span class="ruby-identifier">request_signup</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@offer_match_buckets</span>[<span class="ruby-identifier">count</span>]
      <span class="ruby-ivar">@offer_match_buckets</span>[<span class="ruby-identifier">count</span>].<span class="ruby-identifier">sort_by</span> {<span class="ruby-identifier">rand</span>}.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">offer_signup</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">reload</span>
        <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">assigned_as_offer</span>
        <span class="ruby-constant">ChallengeAssignment</span>.<span class="ruby-identifier">assign_offer!</span>(<span class="ruby-identifier">collection</span>, <span class="ruby-identifier">offer_signup</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">UserMailer</span>.<span class="ruby-identifier">potential_match_generation_notification</span>(<span class="ruby-identifier">collection</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">deliver</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- delayed_generate-source -->
          
        </div>

        

        
      </div><!-- delayed_generate-method -->

    
      <div id="method-c-delayed_send_out" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delayed_send_out</span><span
            class="method-args">(collection_id)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="delayed_send_out-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 231</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">delayed_send_out</span>(<span class="ruby-identifier">collection_id</span>)
  <span class="ruby-identifier">collection</span> = <span class="ruby-constant">Collection</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">collection_id</span>)

  <span class="ruby-comment"># update the collection challenge with the time the assignments are sent</span>
  <span class="ruby-identifier">challenge</span> = <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">challenge</span>
  <span class="ruby-identifier">challenge</span>.<span class="ruby-identifier">assignments_sent_at</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
  <span class="ruby-identifier">challenge</span>.<span class="ruby-identifier">save</span>

  <span class="ruby-comment"># send out each assignment</span>
  <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">assignments</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">assignment</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">send_out</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">notify_maintainers</span>(<span class="ruby-string">&quot;Assignments Sent&quot;</span>, <span class="ruby-string">&quot;All assignments have now been sent out.&quot;</span>)

  <span class="ruby-comment"># purge the potential matches! we don't want bazillions of them in our db</span>
  <span class="ruby-constant">PotentialMatch</span>.<span class="ruby-identifier">clear!</span>(<span class="ruby-identifier">collection</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- delayed_send_out-source -->
          
        </div>

        

        
      </div><!-- delayed_send_out-method -->

    
      <div id="method-c-do_assign_offer-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">do_assign_offer!</span><span
            class="method-args">(assignment, potential_match)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="do_assign_offer-21-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 380</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">do_assign_offer!</span>(<span class="ruby-identifier">assignment</span>, <span class="ruby-identifier">potential_match</span>)
  <span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">request_signup</span> = <span class="ruby-identifier">potential_match</span>.<span class="ruby-identifier">request_signup</span>
  <span class="ruby-identifier">potential_match</span>.<span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">assigned_as_request</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">potential_match</span>.<span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">save!</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- do_assign_offer-21-source -->
          
        </div>

        

        
      </div><!-- do_assign_offer-21-method -->

    
      <div id="method-c-do_assign_request-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">do_assign_request!</span><span
            class="method-args">(assignment, potential_match)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="do_assign_request-21-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 374</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">do_assign_request!</span>(<span class="ruby-identifier">assignment</span>, <span class="ruby-identifier">potential_match</span>)
  <span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">offer_signup</span> = <span class="ruby-identifier">potential_match</span>.<span class="ruby-identifier">offer_signup</span>
  <span class="ruby-identifier">potential_match</span>.<span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">assigned_as_offer</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">potential_match</span>.<span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">save!</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- do_assign_request-21-source -->
          
        </div>

        

        
      </div><!-- do_assign_request-21-method -->

    
      <div id="method-c-generate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">generate</span><span
            class="method-args">(collection)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>generate automatic match for a collection this requires potential matches
to already be generated</p>
          

          
          <div class="method-source-code" id="generate-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 251</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">generate</span>(<span class="ruby-identifier">collection</span>)
  <span class="ruby-constant">Resque</span>.<span class="ruby-identifier">enqueue</span>(<span class="ruby-constant">ChallengeAssignment</span>, <span class="ruby-value">:delayed_generate</span>, <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">id</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- generate-source -->
          
        </div>

        

        
      </div><!-- generate-method -->

    
      <div id="method-c-perform" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">perform</span><span
            class="method-args">(method, *args)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This will be called by a worker when a job needs to be processed</p>
          

          
          <div class="method-source-code" id="perform-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 222</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">perform</span>(<span class="ruby-identifier">method</span>, *<span class="ruby-identifier">args</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>, *<span class="ruby-identifier">args</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- perform-source -->
          
        </div>

        

        
      </div><!-- perform-method -->

    
      <div id="method-c-send_out" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">send_out</span><span
            class="method-args">(collection)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>send assignments out to all participants</p>
          

          
          <div class="method-source-code" id="send_out-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 227</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">send_out</span>(<span class="ruby-identifier">collection</span>)
  <span class="ruby-constant">Resque</span>.<span class="ruby-identifier">enqueue</span>(<span class="ruby-constant">ChallengeAssignment</span>, <span class="ruby-value">:delayed_send_out</span>, <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">id</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- send_out-source -->
          
        </div>

        

        
      </div><!-- send_out-method -->

    
      <div id="method-c-unfulfilled_in_collection" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">unfulfilled_in_collection</span><span
            class="method-args">(collection)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>should be faster than unfulfilled scope because no giant left joins</p>
          

          
          <div class="method-source-code" id="unfulfilled_in_collection-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 73</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">unfulfilled_in_collection</span>(<span class="ruby-identifier">collection</span>)
  <span class="ruby-identifier">fulfilled_ids</span> = <span class="ruby-constant">ChallengeAssignment</span>.<span class="ruby-identifier">in_collection</span>(<span class="ruby-identifier">collection</span>).<span class="ruby-identifier">fulfilled</span>.<span class="ruby-identifier">value_of</span>(<span class="ruby-value">:id</span>)
  <span class="ruby-identifier">fulfilled_ids</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">in_collection</span>(<span class="ruby-identifier">collection</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">in_collection</span>(<span class="ruby-identifier">collection</span>).<span class="ruby-identifier">where</span>(<span class="ruby-string">&quot;challenge_assignments.id NOT IN (?)&quot;</span>, <span class="ruby-identifier">fulfilled_ids</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- unfulfilled_in_collection-source -->
          
        </div>

        

        
      </div><!-- unfulfilled_in_collection-method -->

    
      <div id="method-c-unposted_in_collection" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">unposted_in_collection</span><span
            class="method-args">(collection)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>faster than unposted scope because no left join!</p>
          

          
          <div class="method-source-code" id="unposted_in_collection-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 79</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">unposted_in_collection</span>(<span class="ruby-identifier">collection</span>)
  <span class="ruby-identifier">posted_ids</span> = <span class="ruby-constant">ChallengeAssignment</span>.<span class="ruby-identifier">in_collection</span>(<span class="ruby-identifier">collection</span>).<span class="ruby-identifier">posted</span>.<span class="ruby-identifier">value_of</span>(<span class="ruby-value">:id</span>)
  <span class="ruby-identifier">posted_ids</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">in_collection</span>(<span class="ruby-identifier">collection</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">in_collection</span>(<span class="ruby-identifier">collection</span>).<span class="ruby-identifier">where</span>(<span class="ruby-string">&quot;'challenge_assignments.creation_id IS NULL OR challenge_assignments.id NOT IN (?)&quot;</span>, <span class="ruby-identifier">posted_ids</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- unposted_in_collection-source -->
          
        </div>

        

        
      </div><!-- unposted_in_collection-method -->

    
      <div id="method-c-update_placeholder_assignments-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">update_placeholder_assignments!</span><span
            class="method-args">(collection)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>create placeholders for any assignments left empty (this is for after
manual updates have left some users without an assignment)</p>
          

          
          <div class="method-source-code" id="update_placeholder_assignments-21-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 397</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">update_placeholder_assignments!</span>(<span class="ruby-identifier">collection</span>)
  <span class="ruby-identifier">collection</span>.<span class="ruby-identifier">signups</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">signup</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">signup</span>.<span class="ruby-identifier">request_assignments</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
      <span class="ruby-comment"># get rid of empty placeholders no longer needed</span>
      <span class="ruby-identifier">signup</span>.<span class="ruby-identifier">request_assignments</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">assignment</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">destroy</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">blank?</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">signup</span>.<span class="ruby-identifier">request_assignments</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-comment"># not assigned to giver anymore! :(</span>
      <span class="ruby-identifier">assignment</span> = <span class="ruby-constant">ChallengeAssignment</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:collection</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">collection</span>, <span class="ruby-value">:request_signup</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">signup</span>)
      <span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">save</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">signup</span>.<span class="ruby-identifier">offer_assignments</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">signup</span>.<span class="ruby-identifier">offer_assignments</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">assignment</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">destroy</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">blank?</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">signup</span>.<span class="ruby-identifier">offer_assignments</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-identifier">assignment</span> = <span class="ruby-constant">ChallengeAssignment</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:collection</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">collection</span>, <span class="ruby-value">:offer_signup</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">signup</span>)
      <span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">save</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- update_placeholder_assignments-21-source -->
          
        </div>

        

        
      </div><!-- update_placeholder_assignments-21-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-3C-3D-3E" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">&lt;=&gt;</span><span
            class="method-args">(other)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>sort in order that puts assignments with no request ahead of assignments
with no offer, ahead of assignments with both request and offer, and within
each group sorts by request byline and then offer byline.</p>
          

          
          <div class="method-source-code" id="3C-3D-3E-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 141</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">&lt;=&gt;</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">request_signup</span>
  <span class="ruby-keyword">return</span> <span class="ruby-value">1</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">request_signup</span>
  <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">offer_signup</span>
  <span class="ruby-keyword">return</span> <span class="ruby-value">1</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">offer_signup</span>
  <span class="ruby-identifier">cmp</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">request_byline</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">request_byline</span>.<span class="ruby-identifier">downcase</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">cmp</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">cmp</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">offer_byline</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">offer_byline</span>.<span class="ruby-identifier">downcase</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- 3C-3D-3E-source -->
          
        </div>

        

        
      </div><!-- 3C-3D-3E-method -->

    
      <div id="method-i-clear_assignment" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">clear_assignment</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="clear_assignment-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 96</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">clear_assignment</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">offer_signup</span>
    <span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">assigned_as_offer</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">save</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">request_signup</span>
    <span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">assigned_as_request</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">save</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- clear_assignment-source -->
          
        </div>

        

        
      </div><!-- clear_assignment-method -->

    
      <div id="method-i-cover" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">cover</span><span
            class="method-args">(pseud)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="cover-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 197</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cover</span>(<span class="ruby-identifier">pseud</span>)
  <span class="ruby-identifier">new_assignment</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">covered_at</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">request_assignments</span>.<span class="ruby-identifier">last</span> <span class="ruby-operator">:</span> <span class="ruby-constant">ChallengeAssignment</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">new_assignment</span>.<span class="ruby-identifier">collection</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">collection</span>
  <span class="ruby-identifier">new_assignment</span>.<span class="ruby-identifier">request_signup_id</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">id</span>
  <span class="ruby-identifier">new_assignment</span>.<span class="ruby-identifier">pinch_hitter</span> = <span class="ruby-identifier">pseud</span>
  <span class="ruby-identifier">new_assignment</span>.<span class="ruby-identifier">sent_at</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">new_assignment</span>.<span class="ruby-identifier">save!</span>
  <span class="ruby-identifier">new_assignment</span>.<span class="ruby-identifier">send_out</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">covered_at</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
  <span class="ruby-identifier">new_assignment</span>.<span class="ruby-identifier">save</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">save</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- cover-source -->
          
        </div>

        

        
      </div><!-- cover-method -->

    
      <div id="method-i-default" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">default</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="default-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 192</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">default</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">defaulted_at</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
  <span class="ruby-identifier">save</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- default-source -->
          
        </div>

        

        
      </div><!-- default-method -->

    
      <div id="method-i-defaulted" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">defaulted</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="defaulted-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 133</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">defaulted</span>
  <span class="ruby-operator">!</span><span class="ruby-keyword">self</span>.<span class="ruby-identifier">defaulted_at</span>.<span class="ruby-identifier">nil?</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- defaulted-source -->
          
        </div>

        

        
      </div><!-- defaulted-method -->

    
      <div id="method-i-defaulted-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">defaulted=</span><span
            class="method-args">(value)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="defaulted-3D-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 125</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">defaulted=</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;1&quot;</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">defaulted_at</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">defaulted_at</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- defaulted-3D-source -->
          
        </div>

        

        
      </div><!-- defaulted-3D-method -->

    
      <div id="method-i-fulfilled-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">fulfilled?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="fulfilled-3F-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 117</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">fulfilled?</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">posted?</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">item</span> = <span class="ruby-identifier">get_collection_item</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">item</span>.<span class="ruby-identifier">approved?</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- fulfilled-3F-source -->
          
        </div>

        

        
      </div><!-- fulfilled-3F-method -->

    
      <div id="method-i-get_collection_item" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_collection_item</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="get_collection_item-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 112</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_collection_item</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">creation</span>
  <span class="ruby-constant">CollectionItem</span>.<span class="ruby-identifier">where</span>(<span class="ruby-string">&quot;collection_id = ? AND item_id = ? AND item_type = ?&quot;</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">collection_id</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">creation_id</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">creation_type</span>).<span class="ruby-identifier">first</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- get_collection_item-source -->
          
        </div>

        

        
      </div><!-- get_collection_item-method -->

    
      <div id="method-i-offer_byline" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">offer_byline</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="offer_byline-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 167</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">offer_byline</span>
  <span class="ruby-identifier">offer_signup</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">pseud</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">pseud</span>.<span class="ruby-identifier">byline</span> <span class="ruby-operator">:</span> (<span class="ruby-identifier">pinch_hitter</span> <span class="ruby-operator">?</span> (<span class="ruby-identifier">pinch_hitter</span>.<span class="ruby-identifier">byline</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;* (pinch hitter)&quot;</span>) <span class="ruby-operator">:</span> <span class="ruby-string">&quot;- none -&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- offer_byline-source -->
          
        </div>

        

        
      </div><!-- offer_byline-method -->

    
      <div id="method-i-offering_pseud" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">offering_pseud</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="offering_pseud-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 159</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">offering_pseud</span>
  <span class="ruby-identifier">offer_signup</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">pseud</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">pinch_hitter</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- offering_pseud-source -->
          
        </div>

        

        
      </div><!-- offering_pseud-method -->

    
      <div id="method-i-offering_user" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">offering_user</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="offering_user-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 155</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">offering_user</span>
  <span class="ruby-identifier">offering_pseud</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">offering_pseud</span>.<span class="ruby-identifier">user</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- offering_user-source -->
          
        </div>

        

        
      </div><!-- offering_user-method -->

    
      <div id="method-i-pinch_hitter_byline" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pinch_hitter_byline</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="pinch_hitter_byline-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 175</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pinch_hitter_byline</span>
  <span class="ruby-identifier">pinch_hitter</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">pinch_hitter</span>.<span class="ruby-identifier">byline</span> <span class="ruby-operator">:</span> <span class="ruby-string">&quot;&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- pinch_hitter_byline-source -->
          
        </div>

        

        
      </div><!-- pinch_hitter_byline-method -->

    
      <div id="method-i-pinch_hitter_byline-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pinch_hitter_byline=</span><span
            class="method-args">(byline)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="pinch_hitter_byline-3D-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 179</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pinch_hitter_byline=</span>(<span class="ruby-identifier">byline</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">pinch_hitter</span> = <span class="ruby-constant">Pseud</span>.<span class="ruby-identifier">by_byline</span>(<span class="ruby-identifier">byline</span>).<span class="ruby-identifier">first</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- pinch_hitter_byline-3D-source -->
          
        </div>

        

        
      </div><!-- pinch_hitter_byline-3D-method -->

    
      <div id="method-i-pinch_request_byline" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pinch_request_byline</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="pinch_request_byline-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 183</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pinch_request_byline</span>
  <span class="ruby-identifier">pinch_request_signup</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">pinch_request_signup</span>.<span class="ruby-identifier">pseud</span>.<span class="ruby-identifier">byline</span> <span class="ruby-operator">:</span> <span class="ruby-string">&quot;&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- pinch_request_byline-source -->
          
        </div>

        

        
      </div><!-- pinch_request_byline-method -->

    
      <div id="method-i-pinch_request_byline-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">pinch_request_byline=</span><span
            class="method-args">(byline)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="pinch_request_byline-3D-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 187</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">pinch_request_byline=</span>(<span class="ruby-identifier">byline</span>)
  <span class="ruby-identifier">pinch_pseud</span> = <span class="ruby-constant">Pseud</span>.<span class="ruby-identifier">by_byline</span>(<span class="ruby-identifier">byline</span>).<span class="ruby-identifier">first</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">pinch_request_signup</span> = <span class="ruby-constant">ChallengeSignup</span>.<span class="ruby-identifier">in_collection</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">collection</span>).<span class="ruby-identifier">by_pseud</span>(<span class="ruby-identifier">pinch_pseud</span>).<span class="ruby-identifier">first</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">pinch_pseud</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- pinch_request_byline-3D-source -->
          
        </div>

        

        
      </div><!-- pinch_request_byline-3D-method -->

    
      <div id="method-i-posted-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">posted?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="posted-3F-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 121</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">posted?</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">creation</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">creation</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:posted?</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">creation</span>.<span class="ruby-identifier">posted?</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- posted-3F-source -->
          
        </div>

        

        
      </div><!-- posted-3F-method -->

    
      <div id="method-i-request" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">request</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="request-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 108</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">request</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">request_signup</span> <span class="ruby-operator">||</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">pinch_request_signup</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- request-source -->
          
        </div>

        

        
      </div><!-- request-method -->

    
      <div id="method-i-request_byline" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">request_byline</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="request_byline-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 171</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">request_byline</span>
  <span class="ruby-identifier">request_signup</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">pseud</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">pseud</span>.<span class="ruby-identifier">byline</span> <span class="ruby-operator">:</span> (<span class="ruby-identifier">pinch_request_signup</span> <span class="ruby-operator">?</span> (<span class="ruby-identifier">pinch_request_byline</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;* (pinch recipient)&quot;</span>) <span class="ruby-operator">:</span> <span class="ruby-string">&quot;- None -&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- request_byline-source -->
          
        </div>

        

        
      </div><!-- request_byline-method -->

    
      <div id="method-i-requesting_pseud" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">requesting_pseud</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="requesting_pseud-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 163</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">requesting_pseud</span>
  <span class="ruby-identifier">request_signup</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">request_signup</span>.<span class="ruby-identifier">pseud</span> <span class="ruby-operator">:</span> (<span class="ruby-identifier">pinch_request_signup</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">pinch_request_signup</span>.<span class="ruby-identifier">pseud</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- requesting_pseud-source -->
          
        </div>

        

        
      </div><!-- requesting_pseud-method -->

    
      <div id="method-i-send_out" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">send_out</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="send_out-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 209</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">send_out</span>
  <span class="ruby-comment"># don't resend!</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">sent_at</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">sent_at</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
    <span class="ruby-identifier">save</span>
    <span class="ruby-identifier">assigned_to</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">offer_signup</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">offer_signup</span>.<span class="ruby-identifier">pseud</span>.<span class="ruby-identifier">user</span> <span class="ruby-operator">:</span> (<span class="ruby-keyword">self</span>.<span class="ruby-identifier">pinch_hitter</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">pinch_hitter</span>.<span class="ruby-identifier">user</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>)
    <span class="ruby-identifier">request</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">request_signup</span> <span class="ruby-operator">||</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">pinch_request_signup</span>
    <span class="ruby-constant">UserMailer</span>.<span class="ruby-identifier">challenge_assignment_notification</span>(<span class="ruby-identifier">collection</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">assigned_to</span>.<span class="ruby-identifier">id</span>, <span class="ruby-keyword">self</span>.<span class="ruby-identifier">id</span>).<span class="ruby-identifier">deliver</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">assigned_to</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">request</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- send_out-source -->
          
        </div>

        

        
      </div><!-- send_out-method -->

    
      <div id="method-i-title" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">title</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="title-source">
            <pre><span class="ruby-comment"># File app/models/challenge_assignment.rb, line 151</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">title</span>
  <span class="ruby-node">&quot;#{self.collection.title} (#{self.request_byline})&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- title-source -->
          
        </div>

        

        
      </div><!-- title-method -->

    
    </section><!-- public-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.11.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>


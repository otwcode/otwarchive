<% # this shows challenge assignments when looked at individually from Your Assignments link in user profile or Your Assignment in collection %>
<div id="collection-page" class="collection challenge assignments home profile">
  <!-- /descriptions-->
  <!--subnavigation, sorting and actions-->
  <!--/subnav-->
  <!--main content-->
  <% request = (@challenge_assignment.request_signup || @challenge_assignment.pinch_request_signup) %>
  <h3 class="heading">
    <% if request %>
      <%= ts("Assigned to %{requester}: %{offerer}", :requester => request.pseud.byline, :offerer => @challenge_assignment.offer_byline) %>
      <% if @challenge_assignment.collection.challenge.user_allowed_to_see_assignments?(current_user) %>
        <%= challenge_assignment_email(@challenge_assignment) %>
      <% end %>
    <% else %>
      <%= ts("No Assignment") %>
    <% end %>
  </h3>

  <% if request %>
      <h3 class="heading"><%=h ts("Requests by %{requester}", :requester => request.pseud.byline) %></h3>
      <%= render "challenge_signups/show_requests", :challenge_signup => request %>
    <% else %>
      <p class="note"><%= ts("No request!") %></p>
      <p class="note"><%= ts("Contact challenge moderators for help.") %></p>
    <% end %>
    
    <% if @challenge_assignment.offer_signup %>
      <h3 class="heading"><%=h ts("Offers from %{offerer}", :offerer => @challenge_assignment.offer_byline) %></h3>
      <%= render "challenge_signups/show_offers", :challenge_signup => @challenge_assignment.offer_signup %>
    <% elsif @challenge_assignment.pinch_hitter %>
      <p class="note"><%= ts("Pinch Hitter") %></p>
    <% else %>
      <p class="note"><%= ts("No assigned giver!") %></p>
      <p class="note"><%= ts("Contact challenge moderators for help.") %></p>
    <% end %>
 
  <!--/content-->
  <% if !@challenge_assignment.fulfilled? && @challenge_assignment.offering_pseud.user == current_user %>
    <ul class="navigation actions" role="menu">
      <% if @challenge_assignment.defaulted? %>
        <li><span class="deactivated"><%= ts("Already Defaulted") %></span></li>
      <% else %>
        <li>
          <%= link_to ts("Default"), default_user_assignment_path(@challenge_assignment.offering_pseud.user, @challenge_assignment), 
              :confirm => ts("Are you sure? This will mark you as having defaulted and notify the collection maintainer! It cannot be undone.") %>
        </li>
      <% end %>
      <li><%= link_to ts("Fulfill"), new_collection_work_path(@challenge_assignment.collection, :assignment_id => @challenge_assignment.id) %></li>
    </ul>
  <% end %>
  
</div>


<div id="share">

  <p class="note"><%= ts("Copy and paste the following code to link back to this work (") %><kbd><%= ts("CTRL A")%></kbd><%= ts("/") %><kbd><%= ts("CMD A")%></kbd><%= ts(" will select all), or use the Tweet or Tumblr links to share the work on your Twitter or Tumblr account.") %></p>
  
  <% # HTML share code %>
  <p>
    <textarea cols="50" rows="4" id="<%= shareable.is_a?(Bookmark) ? "embed_code_#{bookmark.id}" : "embed_code" %>"><%= shareable.is_a?(Bookmark) ? get_bookmark_embed_link(bookmark) : get_embed_link(@work) %></textarea>
  </p>
  
  <ul>
    
    <% # Twitter share %>
    <li class="twitter">
      <a href="http://twitter.com/share" class="twitter-share-button" data-size="large" data-via="ao3org" data-text="<%= shareable.is_a?(Bookmark)? get_tweet_text_for_bookmark(bookmark) : get_tweet_text(@work) %>" data-url="<%= shareable.is_a?(Bookmark)? bookmark_url(bookmark) : work_url(@work) %>">
        <%= ts('Tweet') %>
      </a>
    </li>
      
    <% # Tumblr share %>
    <li>
      <a href="http://tumblr.com/widgets/share/tool?canonicalUrl=<%=u shareable.is_a?(Bookmark) ? work_url(bookmark.bookmarkable) : work_url(@work) %>&title=<%=u shareable.is_a?(Bookmark) ? get_tumblr_embed_link_title(bookmark.bookmarkable) : get_tumblr_embed_link_title(@work) %>&caption=<%=u shareable.is_a?(Bookmark) ? get_tumblr_bookmark_embed_link(bookmark) : get_embed_link_meta(@work) %>" title="<%= ts('Share on Tumblr') %>" style="display:inline-block; text-indent:-9999px; overflow:hidden; width:81px; height:20px; background:url('//platform.tumblr.com/v1/share_1.png') top left no-repeat transparent; border-bottom: none;" target="_blank">
        <%= ts('Share on Tumblr') %>
      </a>
    </li>
      
  </ul>
  
</div>

<script>
  // Twitter widgets library bundle is only downloaded once per page.
  if (window.twttr) {
    // If we've already loaded the widgets bundle,
    // trigger rendering of widget elements in the div `share` defined above.
    //
    // See: https://developer.twitter.com/en/docs/twitter-for-websites/javascript-api/guides/scripting-loading-and-initialization
    window.twttr.widgets.load(document.getElementById("share"));
  } else {
    // Otherwise, load the widgets bundle asynchronously.
    // Once the bundle is loaded, it will render all widgets on the page.
    //
    // See: https://developer.twitter.com/en/docs/twitter-for-websites/javascript-api/guides/set-up-twitter-for-websites
    window.twttr = (
      function(d,s,id) {
        var js, fjs = d.getElementsByTagName(s)[0], t=window.twttr || {};
        if (d.getElementById(id)) return t;
        js = d.createElement(s);
        js.id = id;
        js.src = "https://platform.twitter.com/widgets.js";
        fjs.parentNode.insertBefore(js, fjs);
        t._e = [];
        t.ready = function(f) { t._e.push(f); };
        return t;
      }(document, "script", "twitter-wjs")
    );
  }
</script>

<!--Descriptive page name, messages and instructions-->
<h2 class="heading"><%= t(".page_heading") %></h2>
<%= error_messages_for :chapter %>
<!--/descriptions-->

<% if @work.work_skin && !Preference.disable_work_skin?(params[:style]) %>
  <% cache("#{@work.work_skin.id}-#{@work.work_skin.updated_at}-work-skin", skip_digest: true) do %>
    <%= render "skins/skin_style_block", skin: @work.work_skin %>
  <% end %><!-- end cache for work skin -->
<% end %>

<div id="chapters">
  <div id="workskin">
    <%= render @chapter %>
  </div>
</div>

<%= form_for([@work, @chapter]) do |f| %>

  <%= render "hidden_fields", form: f %>

  <fieldset>
    <legend><%= t("works_helper.actions.post_chapter") %></legend>
    <p class="notice">
      <%= t(".post_notice_html",
            content_policy_link: link_to(t(".content_policy"), content_path),
            tos_faq_link: link_to(t(".tos_faq"), tos_faq_path(anchor: "content_faq"))) %>
    </p>
    <ul class="actions">
      <% if @chapter.posted? %>
        <li><%= link_to t("works_helper.actions.edit"), edit_work_chapter_path(@work, @chapter) %></li>
      <% else %>
        <li><%= submit_tag t("works_helper.actions.save_draft"), name: "save_button" %></li>
        <li><%= link_to t("works_helper.actions.edit"), edit_work_chapter_path(@work, @chapter) %></li>
        <li><%= submit_tag t("works_helper.actions.post"),
                           name: "post_button",
                           data: { disable_with: t("works_helper.actions.please_wait") } %></li>
      <% end %>
      <li><%= link_to t("works_helper.actions.cancel"), work_path(@work) %></li>
    </ul>
  </fieldset>

<% end %>

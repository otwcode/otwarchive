<% # expects "work" and "reading" %>
<li <% unless reading.work.nil? %>id="work_<%= work.id %>"<% end %> class="<% if reading.work.nil? %>deleted <% end %><% if is_author_of?(work) %>own <% end %>reading work blurb group" role="article">

  <% unless reading.work.nil? %>

    <%= render 'works/work_module', :work => reading.work %>

  <% end %>

  <div class="user module group">
    <h4 class="viewed heading">

      <% if reading.work.nil? %>

        <%= ts('(Deleted work, last viewed %{date})', :date => set_format_for_date(reading.last_viewed)) %>

      <% else %>

        <span><%= ts('Last viewed:') %></span> <%= set_format_for_date(reading.last_viewed) %>

        <% if reading.major_version_read != reading.work.major_version %>
          <%= ts('(Update available.)') %>
        <% elsif reading.minor_version_read != reading.work.minor_version %>
          <%= ts('(Minor edits made since then.)') %>
        <% else %>
          <%= ts('(Latest version.)') %>
        <% end %>

        <% if reading.view_count == 1 %>
          <%= ts('Viewed once') %>
        <% else %>
          <%= ts('Viewed %{count} times', :count => reading.view_count) %>
        <% end %>

        <% if reading.toread? %>
          <%= ts('(Marked for Later.)') %>
        <% end %>
        <% if reading.toskip? %>
          <%= ts('(Flagged to skip.)') %>
        <% end %>

      <% end %>

    </h4>

    <ul class="actions" role="menu">
      <li>
        <%= form_tag user_reading_path(current_user, reading, page: params[:page]), method: 'delete', class: 'ajax-remove' do |f| %>
          <%= hidden_field_tag :reading, reading.id %>
          <%= submit_tag ts('Delete from History') %>
        <% end %>
      </li>
    </ul>

  </div>

</li>
